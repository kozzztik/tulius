- extends 'html5_empty.html'
- load i18n
- load repeatblock
- enablemacros

- block jquery_styles
    %link{rel: 'stylesheet', type: 'text/css', href: '{{ MEDIA_URL }}jquery/css/jquery-ui-1.10.3.custom.min.css'}

- block bootstrap_styles
    %link{rel: 'stylesheet', type: 'text/css', href: '{{ STATIC_URL }}common/twitter_bootstrap/css/bootstrap.min.css'}
    %link{rel: 'stylesheet', type: 'text/css', href: '{{ STATIC_URL }}common/twitter_bootstrap/css/bootstrap-responsive.min.css'}
    %link{rel: 'stylesheet', type: 'text/css', href: '{{ STATIC_URL }}common/fortawesome/css/font-awesome.min.css'}
    <!--[if IE 7]>
    %link{rel: 'stylesheet', type: 'text/css', href: '{{ STATIC_URL }}common/fortawesome/css/font-awesome-ie7.min.css'}
    <![endif]-->

- block sitewide_styles
    %link{rel: 'stylesheet', type: 'text/css', href: '{{ STATIC_URL }}photos/jquery-lightbox/css/lightbox.css'}
    %link{rel: 'stylesheet', type: 'text/css', href: '{{ STATIC_URL }}tulius/css/tulius2015.css'}
    %link{rel: 'stylesheet', type: 'text/css', href: '{{ MEDIA_URL }}css/tulius.css'}
    %link{rel: 'stylesheet', type: 'text/css', href: '{{ MEDIA_URL }}css/baselayout.css'}
    %link{rel: 'stylesheet', type: 'text/css', href: '{{ MEDIA_URL }}css/tulius-main.css'}
    %link{rel: 'stylesheet', type: 'text/css', href: '{{ MEDIA_URL }}rcrumbs/jquery.rcrumbs.min.css'}
    
- block bootstrap_scripts
    %script{type: 'text/javascript', src: '{{ STATIC_URL }}common/bootstrap/js/bootstrap.min.js'}
    
- block sitewide_scripts
    %script{type: 'text/javascript', src: '{{ MEDIA_URL }}js/jquery.cookie.js'}
    %script{type: 'text/javascript', src: '{{ MEDIA_URL }}js/jquery.history.js'}
    %script{type: 'text/javascript', src: '{{ STATIC_URL }}photos/jquery-lightbox/js/lightbox.js'}
    %script{type: 'text/javascript', src: '{{ STATIC_URL }}autocomplete/autocomplete-select.js'}
    %script{type: 'text/javascript', src: '{{ MEDIA_URL }}rcrumbs/jquery.rcrumbs.min.js'}
    %script1{type: 'text/javascript', src: '{{ STATIC_URL }}js/ws4redis.js'}
    <script type='text/javascript'>
        var websocket_uri = '{{ WEBSOCKET_URI }}';
        {% if not request.user.is_anonymous %}
        var last_read_pm_id = {{ request.user.last_read_pm_id }};
        {% else %}
        var last_read_pm_id = 0;
        {% endif %}
    </script>
    %script{type: 'text/javascript', src: '{{ STATIC_URL }}tulius/js/menu.js'}

    - include "inlineformsets/init.html"
    
    - block extra_scripts
    
- block body
    %body{class: '{% block body_class %}{% endblock %}'}
        - block main_menu
            - include "menu.haml"
        - block body_main_area
            #content-center.container
                - block breadcrumbs_block
                    #top-breadcrumbs.rcrumbs
                        %ul.breadcrumb
                            %li
                                %a{href: '/'}
                                    .homelink
                            - block breadcrumbs
                    .breadcrumbs-border
                #top-center
                    - if messages
                        - for message in messages
                            %div{class: 'alert alert-{{ message.tags }}'}
                                %button.close{type: "button", data-dismiss: "alert"}&times;
                                = message
                - block custom_content
                    .content
                        .caption{align: "center"}
                            .captionleft
                            .captioncontent
                                - block caption
                            .captionright
                        - block content
                - block bottom_breadcrumbs
                    #bottom-breadcrumbs.rcrumbs
                        .breadcrumbs-border
                        %ul.breadcrumb
                            %li
                                %a{href: '/'}
                                    .homelink
                            - repeat breadcrumbs
                - block footer
                  %footer.footer
                    .container.newcontainer
                        - block footer_content
                            %p.pull-left
                                &copy;
                                %a{href: '/'}
                                    Tulius.Com
                                2005-2014
                            - if datablocks.usage_rules
                                %p
                                    %a{href: '{{ datablocks.usage_rules }}'}
                                        {% trans "Service usage rules" %}
                            - if datablocks.confident
                                %p
                                    %a{href: '{{ datablocks.confident }}'}
                                        {% trans "Confidential policy" %}
        - block modals
            - block login_modal
                - if request.user.is_superuser
                    %form#reloginModal.modal.hide.fade.in.well{method: 'POST', action: '{% url "auth:relogin" %}'}
                        - csrf_token
                        .modal-header
                            %a.close{data-dismiss: "modal"}×
                            %h3
                                {% trans "Switch user" %}
                        .modal-body
                            - with field=relogin_form.login_by_user
                                - include 'snippets/form_field.haml'
                            = relogin_form.next_url
                        .modal-footer
                            %button.btn.btn-primary{type: 'submit'}
                                {% trans "Switch" %}
                %form#loginModal.modal.hide.fade.in.well{method: 'POST', action: '{% url "auth:login" %}'}
                    - csrf_token
                    .modal-header
                        %a.close{data-dismiss: "modal"}×
                        %h3
                            {% trans "Login" %}
                    .modal-body
                        - include "login/snippets/login.haml"
    <script type="text/javascript">
        jQuery(document).ready(function() {
            $(".rcrumbs").rcrumbs({nbFixedCrumbs: 1, nbUncollapsableCrumbs: 1});
        });
    </script>
- block title
    - repeat caption